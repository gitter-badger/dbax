<?dbax  
    dbax_core.g$var('active_menu') := 'Applications';
    dbax_core.g$var('page_head') := '
    <!-- SweetAlert 2-->
    <link href="${resources_url}/plugins/sweetalert2/sweetalert2.css" rel="stylesheet" type="text/css" />        
    ';
?>!\n
<?dbax dbax_core.include('header'); ?>

<!-- SideBar -->
<?dbax dbax_core.include('sidebar');?> 

   
 <!-- Content Wrapper. Contains page content -->
      <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
          <h1>
            New Route            
          </h1>
          <ol class="breadcrumb">
             <li><a href="${base_path}/index"><i class="fa fa-dashboard"></i> Home</a></li>
            <li><a href="${base_path}/applications"><i class="fa fa-rocket"></i> Applications</a></li>
            <li><a href="${base_path}/applications/edit/${current_app_id}"><i class="fa fa-cogs"></i> ${current_app_id} </a></li>
            <li><a href="${base_path}/applications/edit/${current_app_id}/routes"><i class="fa fa-road"></i> Routes</a></li>            
            <li>New</li>
          </ol>
        </section>

        <!-- Main content -->
        <section class="content">
           
            <!-- Custom Tabs -->
            <div class="nav-tabs-custom">
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#New" data-toggle="tab">New</a></li>
                    <li><a href="#Test" data-toggle="tab">Test Route</a></li>                                 
                </ul>

                <div class="tab-content">
                    <div class="tab-pane active" id="New">        
        
        
                      <div class="box">
                        <div class="box-header with-border">
                            <h3 class="box-title">Edit</h3>
                        </div><!-- /.box-header -->
                        <div class="box-body">                    
                            
                              <!-- form start -->
                              <form name="routeNewForm" id="routeNewForm" action="${base_path}/applications/edit/${current_app_id}/routes/upsert" class="form-horizontal" method="POST">                        
                                 
                                 <div class="form-group">
                                    <label for="current_app_id" class="col-sm-2 control-label">Application ID</label>
                                    <div class="col-sm-10">
                                      <input type="text" class="form-control" name="current_app_id" id="current_app_id" value="${current_app_id}" readonly="readonly">
                                    </div>
                                  </div>
                                  
                                <div class="form-group">
                                    <label for="route_name" class="col-sm-2 control-label">Route Name</label>
                                    <div class="col-sm-10">
                                      <input type="text" class="form-control" name="route_name" id="route_name" value="${route_name}" required>
                                    </div>
                                </div>  
                                
                                <div class="form-group">
                                    <label for="priority" class="col-sm-2 control-label">Order</label>
                                    <div class="col-sm-10">
                                      <input type="text" class="form-control" name="priority" id="priority" value="${max_priority}" required>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="url_pattern" class="col-sm-2 control-label">URL Pattern</label>
                                    <div class="col-sm-10">
                                      <input type="text" class="form-control" name="url_pattern" id="url_pattern" value="${url_pattern}" maxlength="2000" required>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="controller_method" class="col-sm-2 control-label">Controller or Method</label>
                                    <div class="col-sm-10">
                                      <input type="text" class="form-control" name="controller_method" id="controller_method" value="${controller_method}" maxlength="2000">
                                    </div>
                                </div>                            

                                <div class="form-group">
                                    <label for="view_name" class="col-sm-2 control-label">View Name</label>
                                    <div class="col-sm-10">
                                      <input type="text" class="form-control" name="view_name" id="view_name" value="${view_name}" maxlength="2000">
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                  <label for="active" class="col-sm-2 control-label">Active</label>
                                  <div class="col-sm-10">
                                    <input type="checkbox" name="active" id="active" ${routeActive} />
                                  </div>
                                </div>

                                <div class="form-group">
                                    <label for="description" class="col-sm-2 control-label">Description</label>
                                    <div class="col-sm-10">
                                      <input type="text" class="form-control" name="description" id="description" value="${description}" maxlength="2000">
                                    </div>
                                  </div>                        
                                  
                                  <div class="form-group">
                                    <label for="created_by" class="col-sm-2 control-label">Created By</label>
                                    <div class="col-sm-10">
                                      <input type="text" class="form-control" name="created_by" id="created_by" value="${created_by}" readonly="readonly">
                                    </div>
                                  </div>
                                  
                                  <div class="form-group">
                                    <label for="created_date" class="col-sm-2 control-label">Created Date</label>
                                    <div class="col-sm-10">
                                      <input type="text" class="form-control" name="created_date" id="created_date" value="${created_date}" readonly="readonly">
                                    </div>
                                  </div>                          
                                  
                                  <div class="form-group">
                                    <label for="modified_by" class="col-sm-2 control-label">Modified By</label>
                                    <div class="col-sm-10">
                                      <input type="text" class="form-control" name="modified_by" id="modified_by" value="${modified_by}" readonly="readonly">
                                    </div>
                                  </div>                            

                                  <div class="form-group">
                                    <label for="modified_date" class="col-sm-2 control-label">Modified Date</label>
                                    <div class="col-sm-10">
                                      <input type="text" class="form-control" name="modified_date" id="modified_date" value="${modified_date}" readonly="readonly">
                                    </div>
                                  </div>                          
                                
                              </form>
                        </div><!-- /.box-body -->
                  
                        <div class="box-footer">
                          <button id="routeNewBtn" class="btn btn-info" onclick="SubmitForm('routeNewForm')"><i class="fa fa-save"></i> Save</button>
                          <div class="pull-right">
                            <a href="${base_path}/applications/edit/${current_app_id}#Routes" class="btn btn-danger"><i class="fa fa-chevron-left"></i> Back</a>
                          </div>
                        </div><!-- /.box-footer -->
                    </div> <!-- /.box -->              
             </div><!-- /.tab-pane -->              

              <div class="tab-pane" id="Test">

                <div class="box">
                    <div class="box-header with-border">
                        <h3 class="box-title">Test Route</h3>
                    </div><!-- /.box-header -->
                    <div class="box-body">          

                         <form name="testRouteForm" id="testRouteForm" action="${base_path}/applications/edit/${current_app_id}/routes/test" class="form-horizontal" method="POST">
                            <div class="form-group">
                                <label for="test_url" class="col-sm-2 control-label">Test URL</label>
                                <div class="col-sm-10">
                                  <input type="text" class="form-control" name="test_url" id="test_url" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="url_pattern" class="col-sm-2 control-label">URL Pattern</label>
                                <div class="col-sm-10">
                                  <input type="text" class="form-control" name="url_pattern" id="url_pattern" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="test_controller_method" class="col-sm-2 control-label">Controller or Method</label>
                                <div class="col-sm-10">
                                  <input type="text" class="form-control" name="test_controller_method" id="test_controller_method" maxlength="2000" required>
                                </div>
                            </div> 
                            
                            <div class="form-group">
                                <label for="result" class="col-sm-2 control-label">Result</label>
                                <div class="col-sm-10">                              
                                  <textarea id="result" class="form-control" name="result" readonly="readonly"></textarea>
                                </div>
                            </div>
                            
                         </form>
                            
                    </div><!-- /.box-body -->
                      
                    <div class="box-footer">
                      <button id="testRoute" class="btn btn-info" onclick="SubmitFormTest('testRouteForm')">Run</button>
                      <div class="pull-right">
                        <a href="${base_path}/applications/edit/${current_app_id}#Routes" class="btn btn-danger"><i class="fa fa-chevron-left"></i> Back</a>
                      </div>                      
                    </div><!-- /.box-footer -->
                </div> <!-- /.box -->      
                
              </div><!-- /.tab-pane -->

            </div><!-- /.tab-content -->

          </div><!-- nav-tabs-custom -->
                
        </section><!-- /.content -->
      </div><!-- /.content-wrapper -->

   
    <?dbax dbax_core.include('footer'); ?>

    <!-- JqueryValidate -->
    <script src="https://cdn.jsdelivr.net/jquery.validation/1.14.0/jquery.validate.min.js" type="text/javascript"></script>
    
    <!-- dbaxAdmin -->
    <script src="${resources_url}/plugins/dbaxadmin/dbaxadmin.js" type="text/javascript"></script>
    
    <!-- SweetAlert 2 -->
    <script src="${resources_url}/plugins/sweetalert2/sweetalert2.min.js" type="text/javascript"></script>

      
    <script>    
        //Submit jQuery Ajax Form 
        function SubmitForm(formId){        
            dbaxSubmitForm(formId).done(function(data) {
                if (data.cod_error === undefined)
                    window.location.href = "${base_path}/applications/edit/${current_app_id}/routes/edit/"+$('#route_name').val();
            });
        }  
        
        //Post jQuery Ajax Form 
        function SubmitFormTest(formId){        
            var form =  $('#' + formId);
             if ($(form).validate().form()){ 
                $.post( form.attr('action'), $(form).serialize(), function( data ) {
                    if (data.cod_error === undefined)
                        $('#result').val(data.return);
                 }, "json"); 
             }
        }         
    
     </script> 
 
     
  </body>
</HTML>